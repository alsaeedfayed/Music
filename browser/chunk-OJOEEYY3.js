import{g as W}from"./chunk-AQ5QTCAL.js";import{Bb as v,H as B,Ja as j,Nb as x,P as o,Qa as w,T as I,U as u,Z as h,Za as k,_ as b,_a as P,gb as r,ha as s,hb as c,ib as g,la as l,mb as F,qb as p,rb as f,sb as O,tb as D,ya as T}from"./chunk-ILE2YWSF.js";var V=[[["","customAction",""]],"*"],$=["[customAction]","*"];function G(e,t){if(e&1){let i=F();r(0,"ul",3)(1,"li",5),p("click",function(){h(i);let a=f(2);return b(a.actionClicked("share"))}),r(2,"div",6),g(3,"i",7),r(4,"span"),v(5,"Share"),c()()(),r(6,"li",5),p("click",function(){h(i);let a=f(2);return b(a.actionClicked("artist"))}),r(7,"div",6),g(8,"i",8),r(9,"span"),v(10,"Go To Artist"),c()()(),r(11,"li",5),p("click",function(){h(i);let a=f(2);return b(a.actionClicked("album"))}),r(12,"div",6),g(13,"i",9),r(14,"span"),v(15,"Go To Album"),c()()(),D(16),c()}}function K(e,t){e&1&&(r(0,"ul",4),D(1,1),c())}function H(e,t){if(e&1&&(r(0,"div",2),k(1,G,17,0,"ul",3)(2,K,2,0,"ul",4),c()),e&2){let i=f();T(),P(i.useDefault?1:2)}}var N=class e{isOpen=s(!1);useDefault=!1;menuAction=new w;toggleMenu(){this.isOpen.update(t=>!t)}actionClicked(t){this.menuAction.emit(t),this.isOpen.set(!1)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=j({type:e,selectors:[["app-context-menu"]],inputs:{useDefault:"useDefault"},outputs:{menuAction:"menuAction"},ngContentSelectors:$,decls:3,vars:1,consts:[[1,"context-menu"],[1,"bx","bx-dots-horizontal","fs-2",3,"click"],[1,"context-menu__card"],[1,"default-actions"],[1,"new-actions"],[3,"click"],[1,"context-menu__card--item"],[1,"bx","bx-share-alt"],[1,"bx","bx-user"],[1,"bx","bx-album"]],template:function(i,n){i&1&&(O(V),r(0,"div",0)(1,"i",1),p("click",function(){return n.toggleMenu()}),c(),k(2,H,3,1,"div",2),c()),i&2&&(T(2),P(n.isOpen()?2:-1))},encapsulation:2})};var y=class e{cache=new Map;Set_Cache(t,i){this.cache.set(t,i)}Clear(t){this.cache.delete(t)}Clear_All(){this.cache.clear()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};var R={production:!1,apiBaseUrl:"https://api.deezer.com",apiKeys:{}};var S=class{static BASE=R.apiBaseUrl;static EXPLORE={NEW_RELEASES:`${this.BASE}/chart/0/albums`,TOP_TRACKS:`${this.BASE}/chart/0/tracks`,PODCASTS:`${this.BASE}/chart/0/podcasts`};static SOUNDS={ALBUM:t=>`${this.BASE}/album/${t}/tracks`};static ARTIST={TOP_TRACKS:t=>`${this.BASE}/artist/${t}/top`}};var _=class e{http=u(W);cacheService=u(y);Get_Album(t){let i=this.cacheService.cache.get(t);if(i)return i;let n=S.SOUNDS.ALBUM(t),a=this.http.get(n).pipe(B(1));return this.cacheService.Set_Cache(t,a),a}static \u0275fac=function(i){return new(i||e)};static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};var A=class{constructor(t){this.onEnded=t}audio=null;play(t){this.audio&&(this.audio.pause(),this.audio.currentTime=0),this.audio=new Audio(t),this.audio.onended=this.onEnded,this.audio.play()}pause(){this.audio?.pause()}resume(){this.audio&&this.audio.paused&&this.audio.play()}stop(){this.audio&&(this.audio.pause(),this.audio.currentTime=0)}isPlaying(){return this.audio!=null&&!this.audio.paused}endSong(){}};var m=class{items=s([]);current=s(null);setItems(t){this.items.set(t)}setCurrent(t){this.current.set(t)}addItem(t){this.items.update(i=>[...i,t])}removeItem(t){this.items.update(i=>i.filter(n=>n.id!==t))}};var C=class e extends m{isPlaying=s(!1);playList=s(null);currentCoverPlayList=s(null);currentIndex=x(()=>{let t=this.current();return t?this.playList()?.findIndex(i=>i.id===t.id)??-1:-1});hasNext=x(()=>{let t=this.playList()??[];return this.currentIndex()<t.length-1});hasPrev=x(()=>this.currentIndex()>0);static \u0275fac=(()=>{let t;return function(n){return(t||(t=l(e)))(n||e)}})();static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};var E=class e extends C{audioPlayer=new A(()=>this.onTrackEnded());albums=u(_);setPlayList(t){this.playList.set(t)}playSong(t){if(t){let i=this.current();if(i&&i.id===t.id){this.isPlaying()?this.pause():this.resume();return}this.current.set(t),this.isPlaying.set(!0),this.audioPlayer.play(t.preview),console.log(this.current())}}playListOnClickCover(t){switch(t.type?.()){case"album":this.albums.Get_Album(t.id?.()).subscribe(i=>{this.currentCoverPlayList.set(t);let n=i.data;this.setPlayList(n),this.playSong(n[0])});break;case"track":this.currentCoverPlayList.set(t),this.setPlayList([]),t.rawData&&this.playSong(t.rawData);break;case"podcast":default:break}}pause(){this.audioPlayer.pause(),this.isPlaying.set(!1)}resume(){this.audioPlayer.resume(),this.isPlaying.set(!0)}next(){let t=this.currentIndex(),i=this.playList()??[];if(this.hasNext()){let n=i[t+1];n&&this.playSong(n)}}prev(){let t=this.currentIndex();if(this.hasPrev()){let n=(this.playList()??[])[t-1];this.playSong(n)}}onTrackEnded(){this.hasNext()?this.next():(this.isPlaying.set(!1),this.current.set(null))}static \u0275fac=(()=>{let t;return function(n){return(t||(t=l(e)))(n||e)}})();static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};var M=class e extends m{static \u0275fac=(()=>{let t;return function(n){return(t||(t=l(e)))(n||e)}})();static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};var L=class e extends M{static \u0275fac=(()=>{let t;return function(n){return(t||(t=l(e)))(n||e)}})();static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};var U=class e{constructor(t,i){this.songs=t;this.artists=i}static \u0275fac=function(i){return new(i||e)(I(E),I(L))};static \u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"})};export{S as a,N as b,y as c,_ as d,U as e};
